webpackJsonp([9],{VAon:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n,s,r,l=a("cAgV"),o=a("Q0Ca"),u=a("Xxa5"),c=a.n(u),d=a("exGp"),m=a.n(d),p=a("vLgD"),f=this,h=(i=m()(c.a.mark(function t(e){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(p.a)({url:"platform/index",method:"get",params:e}));case 1:case"end":return t.stop()}},t,f)})),function(t){return i.apply(this,arguments)}),g=(n=m()(c.a.mark(function t(e){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(p.a)({url:"platform/index",method:"post",data:{_id:e}}));case 1:case"end":return t.stop()}},t,f)})),function(t){return n.apply(this,arguments)}),v={update:(s=m()(c.a.mark(function t(e,a){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(p.a)({url:"platform/update/"+e,method:"post",data:a}));case 1:case"end":return t.stop()}},t,f)})),function(t,e){return s.apply(this,arguments)}),getonelist:g,getlist:h,delcount:(r=m()(c.a.mark(function t(e){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(p.a)({url:"platform/delete",method:"post",data:{_id:e}}));case 1:case"end":return t.stop()}},t,f)})),function(t){return r.apply(this,arguments)})},b=a("mtWM"),_=a.n(b),w={directives:{waves:l.a},filters:{transtatus:o.e},data:function(){return{baseimgurl:"http://admin.wumakeji.com/",tableData:[],loading:!1,dialogFormVisible:!1,id:"",url:"",Form:{imgurl:"",title:""},fileList:[],isupdata:!1,FormData:"",rules:{title:[{required:!0,message:"请输入平台名称",trigger:"blur"}]},listQuery:{page:1,limit:10},total:null}},methods:{getlist:function(){var t=this;this.loading=!0,v.getlist(this.listQuery).then(function(e){t.tableData=e.data.platformlist,t.total=e.data.total,t.loading=!1}).catch(function(t){console.log(t)})},handleEdit:function(t){this.id=t,this.dialogFormVisible=!0,this.url="http://admin.wumakeji.com/platform/update/"+this.id},getonelist:function(t){var e=this;v.getonelist(t).then(function(t){200===t.status&&(e.Form.title=t.data.onelist.title,e.fileList.push({url:"http://admin.wumakeji.com/"+t.data.onelist.imgurl}),e.$set(e.Form,"originpic",t.data.onelist.imgurl),e.Form.des=t.data.onelist.des,e.Form.url=t.data.onelist.url,e.Form.order=t.data.onelist.order)}).catch(function(t){console.log("err:"+t)})},upData:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&(t.isupdata?t.$refs.upload.submit():(t.initformdata(),_.a.post("http://admin.wumakeji.com/platform/update/"+t.id,t.FormData).then(function(e){200===e.data.status?(t.$notify({title:"成功",message:e.data.message,type:"success"}),t.getlist(),t.dialogFormVisible=!1):t.$notify.error({title:"失败",message:e.data.message})})))})},handleDelete:function(t){var e=this;this.$confirm("确定删除该记录吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){v.delcount(t).then(function(t){200===t.data.status?(e.$notify({title:"成功",message:t.data.message,type:"success"}),e.getlist()):e.$notify.error({title:"失败",message:t.data.message})})})},uploadsuccess:function(t,e,a){200===t.status?(this.$notify({title:"成功",message:t.message,type:"success"}),this.getlist(),this.dialogFormVisible=!1):this.$notify.error({title:"失败",message:t.message})},initformdata:function(){this.FormData=new FormData,this.FormData.append("title",this.Form.title)},change:function(){this.isupdata=!0},uploading:function(t,e,a){console.log(t.percent)},handleSizeChange:function(t){this.listQuery.limit=t,this.getlist()},handleCurrentChange:function(t){this.listQuery.page=t,this.getlist()}},watch:{dialogFormVisible:{handler:function(){this.dialogFormVisible||(this.id="",this.isupdata=!1)}},id:{handler:function(){this.id?this.getonelist(this.id):this.fileList=[]},immediate:!0}},beforeRouteEnter:function(t,e,a){a(function(t){t.getlist()})}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{staticClass:"path"},[a("span",{staticStyle:{float:"left"}},[t._v("当前位置：")]),t._v(" "),a("el-breadcrumb-item",[t._v("平台管理")]),t._v(" "),a("el-breadcrumb-item",[t._v("平台列表")])],1),t._v(" "),a("div",{staticClass:"platform-container"},[a("div",{staticClass:"table-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"ID",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"排序",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.order))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"平台名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.title))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"",width:"400","平台图片":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:t.baseimgurl+e.row.imgurl,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){t.handleEdit(e.row._id)}}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){t.handleDelete(e.row._id)}}})]}}])})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.total,expression:"total"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[10,20,30,40],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticClass:"platform-form-box"},[a("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.Form,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"平台名称：",prop:"title"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入平台名称"},model:{value:t.Form.title,callback:function(e){t.$set(t.Form,"title",e)},expression:"Form.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"platform：",prop:"pic"}},[a("el-upload",{ref:"upload",attrs:{action:t.url,"file-list":t.fileList,limit:1,data:t.Form,"auto-upload":!1,accept:"image/*","list-type":"picture-card","on-success":t.uploadsuccess,"on-change":t.change}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过100kb")])],1)],1)],1),t._v(" "),a("div",{staticClass:"form-footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.upData(e)}}},[t._v("保存修改")])],1)],1)])],1)},staticRenderFns:[]};var F=a("VU/8")(w,y,!1,function(t){a("s0nF")},"data-v-5f2df73c",null);e.default=F.exports},s0nF:function(t,e){}});
//# sourceMappingURL=9.e8cdd7dd5c56d29d8f3e.js.map