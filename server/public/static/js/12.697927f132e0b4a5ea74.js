webpackJsonp([12],{"0RmE":function(e,t){},r2jk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,n,s,l=a("Xxa5"),o=a.n(l),c=a("exGp"),u=a.n(c),m=a("cAgV"),d=a("Q0Ca"),p=a("vLgD"),h=this,f=(r=u()(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p.a)({url:"loan/index",method:"get",params:t}));case 1:case"end":return e.stop()}},e,h)})),function(e){return r.apply(this,arguments)}),g=(i=u()(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p.a)({url:"loan/index",method:"post",data:{_id:t}}));case 1:case"end":return e.stop()}},e,h)})),function(e){return i.apply(this,arguments)}),v={update:(n=u()(o.a.mark(function e(t,a){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p.a)({url:"loan/update/"+t,method:"post",data:a}));case 1:case"end":return e.stop()}},e,h)})),function(e,t){return n.apply(this,arguments)}),getonelist:g,getlist:f,delcount:(s=u()(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(p.a)({url:"loan/delete",method:"post",data:{_id:t}}));case 1:case"end":return e.stop()}},e,h)})),function(e){return s.apply(this,arguments)})},_=a("mtWM"),b=a.n(_),F={directives:{waves:m.a},filters:{transtatus:d.e},data:function(){var e,t,a,r,i=this;return{tableData:[],loading:!1,dialogFormVisible:!1,id:"",url:"",Form:{title:"",imgurl:"",des:"",url:"",pass_rate:"",success_num:"",money_limit:[],people_limit:[],recommend:!1,status:!1,order:""},fileList:[],isupdata:!1,FormData:"",moneyarr:[{id:1,num:"0-8000元"},{id:2,num:"8000-20000元"},{id:3,num:"20000-80000元"},{id:4,num:"80000元以上"}],peoplearr:[{id:1,type:"上班族"},{id:2,type:"个体户"},{id:3,type:"学生"},{id:4,type:"自由职业者"}],isIndeterminate:!1,isIndeterminate2:!1,checkAll:!1,checkAll2:!1,rules:{title:[{required:!0,message:"请输入贷款名称",trigger:"blur"}],des:[{required:!0,message:"请输入贷款概述",trigger:"blur"}],url:[{validator:(e=u()(o.a.mark(function e(t,a,r){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:""===a?r(new Error("请输入推广链接")):(n=new RegExp("(https?|ftp|file)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]"),n.test(a)||r(new Error("网址格式不正确")),r());case 1:case"end":return e.stop()}},e,i)})),function(t,a,r){return e.apply(this,arguments)}),trigger:"blur"}],pass_rate:[{validator:(t=u()(o.a.mark(function e(t,a,r){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:""!==a?/^[1-9]\d*|0$/.test(a)||r(new Error("请输入数字")):r(new Error("请输入贷款通过率"));case 1:case"end":return e.stop()}},e,i)})),function(e,a,r){return t.apply(this,arguments)}),trigger:"blur"}],success_num:[{validator:(a=u()(o.a.mark(function e(t,a,r){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:""!==a?/^[1-9]\d*|0$/.test(a)||r(new Error("请输入数字")):r(new Error("请输入下款成功数"));case 1:case"end":return e.stop()}},e,i)})),function(e,t,r){return a.apply(this,arguments)}),trigger:"blur"}],order:[{validator:(r=u()(o.a.mark(function e(t,a,r){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:""!==a?/^[1-9]\d*|0$/.test(a)||r(new Error("请输入数字")):r(new Error("请输入排序"));case 1:case"end":return e.stop()}},e,i)})),function(e,t,a){return r.apply(this,arguments)}),trigger:"blur"}]},listQuery:{page:1,limit:10},total:null}},methods:{getlist:function(){var e=this;this.loading=!0,v.getlist(this.listQuery).then(function(t){e.tableData=t.data.loanlist,e.total=t.data.total,e.loading=!1}).catch(function(e){console.log(e)})},handleEdit:function(e){this.id=e,this.dialogFormVisible=!0,this.url="http://admin.wumakeji.com/loan/update/"+this.id},getonelist:function(e){var t=this;v.getonelist(e).then(function(e){if(200===e.status){t.Form.title=e.data.onelist.title,t.fileList.push({url:"http://admin.wumakeji.com/"+e.data.onelist.imgurl}),t.$set(t.Form,"originpic",e.data.onelist.imgurl),t.Form.des=e.data.onelist.des,t.Form.url=e.data.onelist.url,t.Form.pass_rate=e.data.onelist.pass_rate,t.Form.success_num=e.data.onelist.success_num;var a=e.data.onelist.money_limit.split(",");t.Form.money_limit=[],a.forEach(function(e){t.Form.money_limit.push(parseInt(e))}),t.Form.money_limit.length===t.moneyarr.length?(t.isIndeterminate=!1,t.checkAll=!0):(t.isIndeterminate=!0,t.checkAll=!1);var r=e.data.onelist.people_limit.split(",");t.Form.people_limit=[],r.forEach(function(e){t.Form.people_limit.push(parseInt(e))}),t.Form.people_limit.length===t.peoplearr.length?(t.isIndeterminate2=!1,t.checkAll2=!0):(t.isIndeterminate2=!0,t.checkAll2=!1),t.Form.recommend=e.data.onelist.recommend,t.Form.status=e.data.onelist.status,t.Form.order=e.data.onelist.order}}).catch(function(e){console.log("err:"+e)})},upData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){if(0===e.Form.money_limit.length)return e.$message.error("至少选择一项借款额度"),!1;if(0===e.Form.people_limit.length)return e.$message.error("至少选择一项适用人群"),!1;e.isupdata?e.$refs.upload.submit():(e.initformdata(),b.a.post("http://admin.wumakeji.com/loan/update/"+e.id,e.FormData).then(function(t){200===t.data.status?(e.$notify({title:"成功",message:t.data.message,type:"success"}),e.getlist(),e.dialogFormVisible=!1):e.$notify.error({title:"失败",message:t.data.message})}))}})},handleDelete:function(e){var t=this;this.$confirm("确定删除该记录吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){v.delcount(e).then(function(e){200===e.data.status?(t.$notify({title:"成功",message:e.data.message,type:"success"}),t.getlist()):t.$notify.error({title:"失败",message:e.data.message})})})},handleCheckAllChange:function(e){for(var t=[],a=0;a<this.moneyarr.length;a++)t.push(this.moneyarr[a].id);this.Form.money_limit=e?t:[],this.isIndeterminate=!1},handleCheckedmaneyChange:function(e){var t=e.length;this.checkAll=t===this.moneyarr.length,this.isIndeterminate=t>0&&t<this.moneyarr.length},handleCheckAllChange2:function(e){for(var t=[],a=0;a<this.peoplearr.length;a++)t.push(this.peoplearr[a].id);this.Form.people_limit=e?t:[],this.isIndeterminate2=!1},handleCheckedmaneyChange2:function(e){var t=e.length;this.checkAll2=t===this.peoplearr.length,this.isIndeterminate2=t>0&&t<this.peoplearr.length},uploadsuccess:function(e,t,a){200===e.status?(this.$notify({title:"成功",message:e.message,type:"success"}),this.getlist(),this.dialogFormVisible=!1):this.$notify.error({title:"失败",message:e.message})},initformdata:function(){this.FormData=new FormData,this.FormData.append("title",this.Form.title),this.FormData.append("des",this.Form.des),this.FormData.append("url",this.Form.url),this.FormData.append("pass_rate",this.Form.pass_rate),this.FormData.append("success_num",this.Form.success_num),this.FormData.append("money_limit",this.Form.money_limit),this.FormData.append("people_limit",this.Form.people_limit),this.FormData.append("recommend",this.Form.recommend),this.FormData.append("status",this.Form.status),this.FormData.append("order",this.Form.order)},change:function(){this.isupdata=!0},uploading:function(e,t,a){console.log(e.percent)},handleSizeChange:function(e){this.listQuery.limit=e,this.getlist()},handleCurrentChange:function(e){this.listQuery.page=e,this.getlist()}},watch:{dialogFormVisible:{handler:function(){this.dialogFormVisible||(this.id="",this.isupdata=!1)}},id:{handler:function(){this.id?this.getonelist(this.id):this.fileList=[]},immediate:!0}},beforeRouteEnter:function(e,t,a){a(function(e){e.getlist()})}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{staticClass:"path"},[a("span",{staticStyle:{float:"left"}},[e._v("当前位置：")]),e._v(" "),a("el-breadcrumb-item",[e._v("贷款管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/loan/index"}}},[e._v("贷款列表")])],1),e._v(" "),a("div",{staticClass:"loan-container"},[a("div",{staticClass:"table-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{label:"ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+1))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"排序",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.order))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"贷款名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.title))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"贷款概述"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.des))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"推广链接"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.url))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("transtatus")(t.row.status)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){e.handleEdit(t.row._id)}}}),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.handleDelete(t.row._id)}}})]}}])})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.total,expression:"total"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,40],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticClass:"form-box"},[a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.Form,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"贷款名称：",prop:"title"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"贷款名称"},model:{value:e.Form.title,callback:function(t){e.$set(e.Form,"title",t)},expression:"Form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"贷款icon：",prop:"pic"}},[a("el-upload",{ref:"upload",attrs:{action:e.url,"file-list":e.fileList,limit:1,data:e.Form,"auto-upload":!1,accept:"image/*","list-type":"picture-card","on-success":e.uploadsuccess,"on-change":e.change}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过100kb")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"贷款概述：",prop:"des"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{type:"textarea",placeholder:"贷款概述",autosize:{minRows:2,maxRows:4}},model:{value:e.Form.des,callback:function(t){e.$set(e.Form,"des",t)},expression:"Form.des"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"推广链接：",prop:"url"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"推广链接"},model:{value:e.Form.url,callback:function(t){e.$set(e.Form,"url",t)},expression:"Form.url"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"贷款通过率：",prop:"pass_rate"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"贷款通过率（数字）"},model:{value:e.Form.pass_rate,callback:function(t){e.$set(e.Form,"pass_rate",t)},expression:"Form.pass_rate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"成功下款数：",prop:"success_num"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"成功下款数（数字）"},model:{value:e.Form.success_num,callback:function(t){e.$set(e.Form,"success_num",t)},expression:"Form.success_num"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"可借款额度："}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedmaneyChange},model:{value:e.Form.money_limit,callback:function(t){e.$set(e.Form,"money_limit",t)},expression:"Form.money_limit"}},e._l(e.moneyarr,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.num))])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"适合人群："}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate2},on:{change:e.handleCheckAllChange2},model:{value:e.checkAll2,callback:function(t){e.checkAll2=t},expression:"checkAll2"}},[e._v("全选")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedmaneyChange2},model:{value:e.Form.people_limit,callback:function(t){e.$set(e.Form,"people_limit",t)},expression:"Form.people_limit"}},e._l(e.peoplearr,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.type))])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"是否首页推荐："}},[a("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:e.Form.recommend,callback:function(t){e.$set(e.Form,"recommend",t)},expression:"Form.recommend"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否开启："}},[a("el-switch",{attrs:{"active-text":"开启","inactive-text":"暂停"},model:{value:e.Form.status,callback:function(t){e.$set(e.Form,"status",t)},expression:"Form.status"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序：",prop:"order"}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"排序（数字）"},model:{value:e.Form.order,callback:function(t){e.$set(e.Form,"order",t)},expression:"Form.order"}})],1)],1),e._v(" "),a("div",{staticClass:"form-footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.upData(t)}}},[e._v("保存修改")])],1)],1)])],1)},staticRenderFns:[]};var k=a("VU/8")(F,y,!1,function(e){a("0RmE")},"data-v-1bf0f19a",null);t.default=k.exports}});
//# sourceMappingURL=12.697927f132e0b4a5ea74.js.map