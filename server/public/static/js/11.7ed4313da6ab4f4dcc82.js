webpackJsonp([11],{"6hpC":function(t,e){},vFK7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n,i,s,o=a("Xxa5"),l=a.n(o),u=a("exGp"),c=a.n(u),d=a("cAgV"),p=a("Q0Ca"),m=a("vLgD"),f=this,h=(r=c()(l.a.mark(function t(e){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(m.a)({url:"banner/index",method:"get",params:e}));case 1:case"end":return t.stop()}},t,f)})),function(t){return r.apply(this,arguments)}),b=(n=c()(l.a.mark(function t(e){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(m.a)({url:"banner/index",method:"post",data:{_id:e}}));case 1:case"end":return t.stop()}},t,f)})),function(t){return n.apply(this,arguments)}),g={update:(i=c()(l.a.mark(function t(e,a){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(m.a)({url:"banner/update/"+e,method:"post",data:a}));case 1:case"end":return t.stop()}},t,f)})),function(t,e){return i.apply(this,arguments)}),getonelist:b,getlist:h,delcount:(s=c()(l.a.mark(function t(e){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(m.a)({url:"banner/delete",method:"post",data:{_id:e}}));case 1:case"end":return t.stop()}},t,f)})),function(t){return s.apply(this,arguments)})},v=a("mtWM"),w=a.n(v),_={directives:{waves:d.a},filters:{transtatus:p.e},data:function(){var t,e,a=this;return{baseimgurl:"http://admin.wumakeji.com/",tableData:[],loading:!1,dialogFormVisible:!1,id:"",url:"",Form:{imgurl:"",des:"",url:"",order:""},fileList:[],isupdata:!1,FormData:"",rules:{des:[{required:!0,message:"请输入banner概述",trigger:"blur"}],url:[{validator:(t=c()(l.a.mark(function t(e,r,n){var i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:""===r?n(new Error("请输入banner链接")):(i=new RegExp("(https?|ftp|file)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]"),i.test(r)||n(new Error("网址格式不正确")),n());case 1:case"end":return t.stop()}},t,a)})),function(e,a,r){return t.apply(this,arguments)}),trigger:"blur"}],order:[{validator:(e=c()(l.a.mark(function t(e,r,n){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:""!==r?/^[1-9]\d*|0$/.test(r)||n(new Error("请输入数字")):n(new Error("请输入排序"));case 1:case"end":return t.stop()}},t,a)})),function(t,a,r){return e.apply(this,arguments)}),trigger:"blur"}]},listQuery:{page:1,limit:10},total:null}},methods:{getlist:function(){var t=this;this.loading=!0,g.getlist(this.listQuery).then(function(e){t.tableData=e.data.bannerlist,t.total=e.data.total,t.loading=!1}).catch(function(t){console.log(t)})},handleEdit:function(t){this.id=t,this.dialogFormVisible=!0,this.url="http://admin.wumakeji.com/banner/update/"+this.id},getonelist:function(t){var e=this;g.getonelist(t).then(function(t){200===t.status&&(e.Form.title=t.data.onelist.title,e.fileList.push({url:"http://admin.wumakeji.com/"+t.data.onelist.imgurl}),e.$set(e.Form,"originpic",t.data.onelist.imgurl),e.Form.des=t.data.onelist.des,e.Form.url=t.data.onelist.url,e.Form.order=t.data.onelist.order)}).catch(function(t){console.log("err:"+t)})},upData:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&(t.isupdata?t.$refs.upload.submit():(t.initformdata(),w.a.post("http://admin.wumakeji.com/banner/update/"+t.id,t.FormData).then(function(e){200===e.data.status?(t.$notify({title:"成功",message:e.data.message,type:"success"}),t.getlist(),t.dialogFormVisible=!1):t.$notify.error({title:"失败",message:e.data.message})})))})},handleDelete:function(t){var e=this;this.$confirm("确定删除该记录吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){g.delcount(t).then(function(t){200===t.data.status?(e.$notify({title:"成功",message:t.data.message,type:"success"}),e.getlist()):e.$notify.error({title:"失败",message:t.data.message})})})},uploadsuccess:function(t,e,a){200===t.status?(this.$notify({title:"成功",message:t.message,type:"success"}),this.getlist(),this.dialogFormVisible=!1):this.$notify.error({title:"失败",message:t.message})},initformdata:function(){this.FormData=new FormData,this.FormData.append("des",this.Form.des),this.FormData.append("url",this.Form.url),this.FormData.append("order",this.Form.order)},change:function(){this.isupdata=!0},uploading:function(t,e,a){console.log(t.percent)},handleSizeChange:function(t){this.listQuery.limit=t,this.getlist()},handleCurrentChange:function(t){this.listQuery.page=t,this.getlist()}},watch:{dialogFormVisible:{handler:function(){this.dialogFormVisible||(this.id="",this.isupdata=!1)}},id:{handler:function(){this.id?this.getonelist(this.id):this.fileList=[]},immediate:!0}},beforeRouteEnter:function(t,e,a){a(function(t){t.getlist()})}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{staticClass:"path"},[a("span",{staticStyle:{float:"left"}},[t._v("当前位置：")]),t._v(" "),a("el-breadcrumb-item",[t._v("banner管理")]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/banner/index"}}},[t._v("banner列表")])],1),t._v(" "),a("div",{staticClass:"banner-container"},[a("div",{staticClass:"table-container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"ID",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"排序",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.order))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"banner",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"375px",height:"115px"},attrs:{src:t.baseimgurl+e.row.imgurl,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"banner概述"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.des))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"推广链接"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.url))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(a){t.handleEdit(e.row._id)}}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){t.handleDelete(e.row._id)}}})]}}])})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.total,expression:"total"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[10,20,30,40],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)]),t._v(" "),a("el-dialog",{attrs:{title:"编辑",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticClass:"banner-form-box"},[a("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.Form,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"banner：",prop:"pic"}},[a("el-upload",{ref:"upload",attrs:{action:t.url,"file-list":t.fileList,limit:1,data:t.Form,"auto-upload":!1,accept:"image/*","list-type":"picture-card","on-success":t.uploadsuccess,"on-change":t.change}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过100kb")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"banner概述：",prop:"des"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{type:"textarea",placeholder:"banner概述",autosize:{minRows:2,maxRows:4}},model:{value:t.Form.des,callback:function(e){t.$set(t.Form,"des",e)},expression:"Form.des"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"banner链接：",prop:"url"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"banner链接"},model:{value:t.Form.url,callback:function(e){t.$set(t.Form,"url",e)},expression:"Form.url"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"排序：",prop:"order"}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"排序（数字）"},model:{value:t.Form.order,callback:function(e){t.$set(t.Form,"order",e)},expression:"Form.order"}})],1)],1),t._v(" "),a("div",{staticClass:"form-footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.upData(e)}}},[t._v("保存修改")])],1)],1)])],1)},staticRenderFns:[]};var F=a("VU/8")(_,y,!1,function(t){a("6hpC")},"data-v-51fb9862",null);e.default=F.exports}});
//# sourceMappingURL=11.7ed4313da6ab4f4dcc82.js.map